{"version":3,"file":"static/js/82.05ec0e6d.chunk.js","mappings":"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","sources":["component/products/singlepurchase.js"],"sourcesContent":["import axios from 'axios';\r\nimport { useContext, useState, useEffect } from 'react';\r\nimport DataContext from '../usecontext/DataContext';\r\nimport { MdEdit, MdDelete, MdOutlineSystemSecurityUpdate } from \"react-icons/md\";\r\n\r\nexport default function SinglePurchase() {\r\n    const { singlepurchase, fetchSinglePurchase } = useContext(DataContext);\r\n    const [isEditing, setIsEditing] = useState(false);\r\n    const [editedPurchase, setEditedPurchase] = useState(singlepurchase);\r\n    const [suppliers, setSuppliers] = useState([]);\r\n    const [productQuery, setProductQuery] = useState('');\r\n    const [supplierQuery, setSupplierQuery] = useState('');\r\n    const [filteredSuppliers, setFilteredSuppliers] = useState([]);\r\n    const [products, setProducts] = useState([]);\r\n    const [filteredProducts, setFilteredProducts] = useState([]);\r\n    const apiKey = \"https://backend-mqr6.onrender.com\";\r\n    const [focusedIndex , setFocusedIndex] = useState([]);\r\n    const { userrole } = useContext(DataContext);\r\n\r\n    useEffect(() => {\r\n        const fetchProducts = async () => {\r\n            try {\r\n                let token = localStorage.getItem(\"token\");\r\n                const response = await axios.get(`${apiKey}/api/product/productnames`, {\r\n                    headers: { 'authtoken': token }\r\n                });\r\n                setProducts(response.data.productNames);\r\n            } catch (error) {\r\n                console.error('Error fetching products:', error);\r\n            }\r\n        };\r\n\r\n        const fetchSuppliers = async () => {\r\n            try {\r\n                let token = localStorage.getItem(\"token\");\r\n                const response = await axios.get(`${apiKey}/api/supplier/suppliernames`, {\r\n                    headers: { 'authtoken': token }\r\n                });\r\n                setSuppliers(response.data.supplierNames);\r\n            } catch (error) {\r\n                console.error('Error fetching suppliers:', error);\r\n            }\r\n        };\r\n\r\n        fetchProducts();\r\n        fetchSuppliers();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (productQuery) {\r\n            setFilteredProducts(products.filter(name =>\r\n                name.toLowerCase().includes(productQuery.toLowerCase())\r\n            ));\r\n        } else {\r\n            setFilteredProducts([]);\r\n        }\r\n    }, [productQuery, products]);\r\n\r\n    useEffect(() => {\r\n        if (supplierQuery) {\r\n            setFilteredSuppliers(suppliers.filter(name =>\r\n                name.toLowerCase().includes(supplierQuery.toLowerCase())\r\n            ));\r\n        } else {\r\n            setFilteredSuppliers([]);\r\n        }\r\n    }, [supplierQuery, suppliers]);\r\n\r\n    const handleEditClick = () => {\r\n        setEditedPurchase(singlepurchase);\r\n        setIsEditing(true);\r\n    };\r\n\r\n    const handleProductSuggestionClick = async (name, index) => {\r\n        try {\r\n            let token = localStorage.getItem(\"token\");\r\n            const response = await axios.get(`${apiKey}/api/product/fetchsingleproduct/${name}`, {\r\n                headers: { 'authtoken': token }\r\n            });\r\n            const productDetails = response.data.othername1;\r\n\r\n            const updatedPurchase = { ...editedPurchase };\r\n            updatedPurchase.purchase.name[index] = {\r\n                ...updatedPurchase.purchase.name[index],\r\n                productname: productDetails.name,\r\n                productid: productDetails._id,\r\n            };\r\n\r\n            setEditedPurchase(updatedPurchase);\r\n            console.log(updatedPurchase)\r\n            setFilteredProducts([]);\r\n        } catch (error) {\r\n            console.error('Error fetching product details:', error);\r\n        }\r\n    };\r\n\r\n    const handleInputChange = (e, field, index) => {\r\n        const { value } = e.target;\r\n        const updatedPurchase = { ...editedPurchase };\r\n    \r\n        if (field === 'serialNumbers') {\r\n            const updatedSerialNumbers = value.split(',').map(serial => serial.trim());\r\n            updatedPurchase.purchase.name[index][field] = updatedSerialNumbers;\r\n        } else {\r\n            updatedPurchase.purchase.name[index][field] = value;\r\n    \r\n            // Update other fields based on the input change\r\n            if (field === 'quantity' || field === 'rateper') {\r\n                updateAmount(index);\r\n            } else if (field === 'amount') {\r\n                updateRatePer(index);\r\n            }\r\n        }\r\n    \r\n        setEditedPurchase(updatedPurchase);\r\n    };\r\n    \r\n    // Function to calculate amount based on quantity and rateper\r\n    const updateAmount = (index) => {\r\n        const updatedPurchase = { ...editedPurchase };\r\n        const quantity = parseFloat(updatedPurchase.purchase.name[index]?.quantity || 0);\r\n        const rateper = parseFloat(updatedPurchase.purchase.name[index]?.rateper || 0);\r\n        const amount = quantity * rateper;\r\n    \r\n        updatedPurchase.purchase.name[index].amount = amount \r\n        setEditedPurchase(updatedPurchase);\r\n    };\r\n    \r\n    // Function to calculate rateper based on amount and quantity\r\n    const updateRatePer = (index) => {\r\n        const updatedPurchase = { ...editedPurchase };\r\n        const quantity = parseFloat(updatedPurchase.purchase.name[index]?.quantity || 0);\r\n        const amount = parseFloat(updatedPurchase.purchase.name[index]?.amount || 0);\r\n    \r\n        if (quantity > 0) {\r\n            const rateper = amount / quantity;\r\n            updatedPurchase.purchase.name[index].rateper = rateper;\r\n        } else {\r\n            updatedPurchase.purchase.name[index].rateper = '';\r\n        }\r\n    \r\n        setEditedPurchase(updatedPurchase);\r\n    };\r\n    \r\n    \r\n    \r\n\r\n    const handleChangesupplier = (e, field) => {\r\n        const value = e.target.value;\r\n        if (suppliers.some(name => name.toLowerCase().includes(value.toLowerCase()))) {\r\n            const updatedPurchase = { ...editedPurchase };\r\n            updatedPurchase.purchase[field] = value; // Update the Supplier field\r\n            setEditedPurchase(updatedPurchase);\r\n        }\r\n    };\r\n\r\n    const handleSupplierSuggestionClick = (name) => {\r\n        setEditedPurchase({\r\n            ...editedPurchase,\r\n            purchase: {\r\n                ...editedPurchase?.purchase,\r\n                Supplier: name\r\n            }\r\n        });\r\n        setFilteredSuppliers([]);\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        try {\r\n            await updatePurchase(editedPurchase);\r\n            setIsEditing(false);\r\n        } catch (error) {\r\n            console.error(\"Failed to update purchase\", error);\r\n        }\r\n    };\r\n\r\n    const updatePurchase = async (editedPurchase) => {\r\n        try {\r\n            let token = localStorage.getItem(\"token\");\r\n            await axios.put(\r\n                `${apiKey}/api/purchase/updatepurchase/${editedPurchase?.purchase._id}`,\r\n                editedPurchase?.purchase,\r\n                {\r\n                    headers: {\r\n                        'authtoken': token\r\n                    },\r\n                }\r\n            );\r\n            alert('Purchase updated successfully');\r\n            fetchSinglePurchase(editedPurchase?.purchase._id);\r\n        } catch (error) {\r\n            console.error(error);\r\n            alert('Error updating purchase');\r\n            fetchSinglePurchase(editedPurchase?.purchase._id);\r\n        }\r\n    };\r\n\r\n    const deleteProduct = async (id) => {\r\n        try {\r\n            let token = localStorage.getItem('token');\r\n            await axios.delete(`${apiKey}/api/purchase/deletepurchase/${id}`, {\r\n                headers: {\r\n                    'authtoken': token\r\n                },\r\n            });\r\n            fetchSinglePurchase(id);\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n\r\n    const confirmDelete = (id) => {\r\n        setIsEditing(false);\r\n        if (window.confirm(\"Do you really want to delete?\")) {\r\n            deleteProduct(id);\r\n        }\r\n    };\r\n    \r\n    const date = new Date(editedPurchase?.purchase?.billdate);\r\n    const options = { year: 'numeric', month: '2-digit', day: '2-digit' };\r\n    let newdate = date.toLocaleDateString('en-IN', options).split('/')?.join('-');\r\n    \r\n    console.log(editedPurchase?.purchase)\r\n    return (\r\n        <div className=\" \">\r\n            <div className=\"mt-4 lg:w-full\">\r\n                <div className=\"form-inline flex relative justify-between\">\r\n                    <div className='w-[33%] font-semibold'>Supplier</div>\r\n                    <div className='w-[33%] font-semibold'>Bill No</div>\r\n                    <div className='w-[33%] font-semibold'>Bill Date</div>\r\n                    <div>\r\n                        {userrole.canEdit && isEditing ? (\r\n                            <>\r\n                                <button onClick={handleSave}><MdOutlineSystemSecurityUpdate /></button>\r\n                                <button onClick={() => setIsEditing(false)}>Cancel</button>\r\n                            </>\r\n                        ) : (<>\r\n                            {userrole.canEdit &&\r\n                            <button onClick={handleEditClick}><MdEdit /></button>}\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-inline flex relative justify-between\">\r\n                    <div className='w-[33%]'>\r\n                        {userrole.canEdit && isEditing ? (\r\n                            <>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={editedPurchase?.purchase?.Supplier || ''}\r\n                                    onChange={(e) => {\r\n                                        handleChangesupplier(e, 'Supplier'); // Ensure this updates the Supplier field\r\n                                        setSupplierQuery(e.target.value);\r\n                                    }}\r\n                                />\r\n                                {filteredSuppliers.length > 0 && (\r\n                                    <div className='absolute bg-gray-300 px-3 rounded-md'>\r\n                                        <div className=\"suggestions\">\r\n                                            {filteredSuppliers.map((name, index) => (\r\n                                                <div\r\n                                                    key={index}\r\n                                                    className=\"suggestion cursor-pointer\"\r\n                                                    onClick={() => handleSupplierSuggestionClick(name)}\r\n                                                >\r\n                                                    {name}\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </>\r\n                        ) : (\r\n                            singlepurchase?.purchase?.Supplier\r\n                        )}\r\n                    </div>\r\n                    <div className='w-[33%]'>\r\n                        {isEditing ? (\r\n                            <input\r\n                                type=\"text\"\r\n                                value={editedPurchase?.purchase?.billno || ''}\r\n                                onChange={(e) => handleInputChange(e, 'billno')}\r\n                            />\r\n                        ) : (\r\n                            singlepurchase?.purchase?.billno\r\n                        )}\r\n                    </div>\r\n                    <div className='w-[33%]'>\r\n                        {isEditing ? (\r\n                            <input\r\n                                type=\"date\"\r\n                                value={newdate?.split('-')?.reverse()?.join('-')}\r\n                                onChange={(e) => handleInputChange(e, 'billdate')}\r\n                            />\r\n                        ) : (\r\n                            newdate\r\n                        )}\r\n                    </div>\r\n                    {userrole.canDelete &&\r\n                    <div className='cursor-pointer' onClick={() => confirmDelete(singlepurchase?.purchase?._id)}>\r\n                        <MdDelete />\r\n                    </div>}\r\n                </div>\r\n                <div className=\"form-inline flex relative mt-6 justify-between\">\r\n                    <div className='w-[20%] font-semibold'>Product Name</div>\r\n                    <div className='w-[20%] font-semibold'>Quantity</div>\r\n                    <div className='w-[20%] font-semibold'>rateper</div>\r\n                    <div className='w-[20%] font-semibold'>Amount</div>\r\n                    <div className='w-[20%] font-semibold'>Serial Numbers</div>\r\n                </div>\r\n                {singlepurchase?.purchase?.name.map((product, index) => (\r\n                    <div className=\"form-inline flex relative mt-3 justify-between\" key={index}>\r\n                        <div className='w-[20%]'>\r\n                            {isEditing ? (\r\n                                <>\r\n                                    <input\r\n                                    onFocus={() => setFocusedIndex(index)}\r\n                                        type=\"text\"\r\n                                        value={editedPurchase?.purchase?.name[index]?.productname || ''}\r\n                                        onChange={(e) => {\r\n                                            handleInputChange(e, 'productname', index);\r\n                                            setProductQuery(e.target.value);\r\n                                        }}\r\n                                    />\r\n                                    {focusedIndex === index && filteredProducts.length > 0 && (\r\n                                        <div className='absolute bg-gray-300 px-3 rounded-md'>\r\n                                            <div className=\"suggestions bg-gray-300 absolute z-30 h-36 overflow-y-auto\">\r\n                                                {filteredProducts.map((name, idx) => (\r\n                                                    <div\r\n                                                        key={idx}\r\n                                                        className=\"suggestion cursor-pointer\"\r\n                                                        onClick={() => handleProductSuggestionClick(name, index)}\r\n                                                    >\r\n                                                        {name}\r\n                                                    </div>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </>\r\n                            ) : (\r\n                                singlepurchase?.purchase?.name[index]?.productname\r\n                            )}\r\n                        </div>\r\n                        <div className='w-[20%]'>\r\n                            {isEditing ? (\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={editedPurchase?.purchase?.name[index]?.quantity || ''}\r\n                                    onChange={(e) => handleInputChange(e, 'quantity', index)}\r\n                                />\r\n                            ) : (\r\n                                singlepurchase?.purchase?.name[index]?.quantity\r\n                            )}\r\n                        </div>\r\n                        <div className='w-[20%]'>\r\n                            {isEditing ? (\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={editedPurchase?.purchase?.name[index]?.rateper || ''}\r\n                                    onChange={(e) => handleInputChange(e, 'rateper', index)}\r\n                                />\r\n                            ) : (\r\n                                singlepurchase?.purchase?.name[index]?.rateper\r\n                            )}\r\n                        </div>\r\n                        <div className='w-[20%]'>\r\n                            {isEditing ? (\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={editedPurchase?.purchase?.name[index]?.amount || ''}\r\n                                    onChange={(e) => handleInputChange(e, 'amount', index)}\r\n                                />\r\n                            ) : (\r\n                                singlepurchase?.purchase?.name[index]?.amount\r\n                            )}\r\n                        </div>\r\n                        <div className='w-[20%]'>\r\n                            {isEditing ? (\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={editedPurchase?.purchase?.name[index]?.serialNumbers?.join(', ') || ''}\r\n                                    onChange={(e) => handleInputChange(e, 'serialNumbers', index)}\r\n                                />\r\n                            ) : (\r\n                                (singlepurchase?.purchase?.name[index]?.serialNumbers || []).join(', ')\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":["SinglePurchase","_editedPurchase$purch","_date$toLocaleDateStr","_editedPurchase$purch2","_singlepurchase$purch","_editedPurchase$purch3","_singlepurchase$purch2","_newdate$split","_newdate$split$revers","_singlepurchase$purch4","singlepurchase","fetchSinglePurchase","useContext","DataContext","isEditing","setIsEditing","useState","editedPurchase","setEditedPurchase","suppliers","setSuppliers","productQuery","setProductQuery","supplierQuery","setSupplierQuery","filteredSuppliers","setFilteredSuppliers","products","setProducts","filteredProducts","setFilteredProducts","apiKey","focusedIndex","setFocusedIndex","userrole","useEffect","async","token","localStorage","getItem","response","axios","get","headers","data","productNames","error","console","fetchProducts","supplierNames","fetchSuppliers","filter","name","toLowerCase","includes","handleInputChange","e","field","index","value","target","updatedPurchase","updatedSerialNumbers","split","map","serial","trim","purchase","updateAmount","updateRatePer","_updatedPurchase$purc","_updatedPurchase$purc2","amount","parseFloat","quantity","rateper","_updatedPurchase$purc3","_updatedPurchase$purc4","updatePurchase","put","_id","alert","confirmDelete","id","window","confirm","delete","deleteProduct","newdate","Date","billdate","toLocaleDateString","year","month","day","join","log","_jsx","className","children","_jsxs","canEdit","_Fragment","onClick","MdOutlineSystemSecurityUpdate","handleEditClick","MdEdit","type","Supplier","onChange","handleChangesupplier","some","length","handleSupplierSuggestionClick","billno","reverse","canDelete","_singlepurchase$purch3","MdDelete","product","_editedPurchase$purch4","_editedPurchase$purch5","_singlepurchase$purch5","_singlepurchase$purch6","_editedPurchase$purch6","_editedPurchase$purch7","_singlepurchase$purch7","_singlepurchase$purch8","_editedPurchase$purch8","_editedPurchase$purch9","_singlepurchase$purch9","_singlepurchase$purch10","_editedPurchase$purch10","_editedPurchase$purch11","_singlepurchase$purch11","_singlepurchase$purch12","_editedPurchase$purch12","_editedPurchase$purch13","_editedPurchase$purch14","_singlepurchase$purch13","_singlepurchase$purch14","onFocus","productname","idx","productDetails","othername1","productid","handleProductSuggestionClick","serialNumbers"],"sourceRoot":""}